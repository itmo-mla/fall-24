## Лабораторная работа 2

Датасет "Ирисы Фишера" (ссылка: https://www.kaggle.com/datasets/uciml/iris?select=Iris.csv)

## Решение

Была реализована и протестирована модель классификации, основанная на методе k-ближайших соседей с использованием окна Парзена. Окно Парзена использует функцию ядра для оценки плонтости вероятности в многомерном пространстве, что позволяет более гибко учитывать влияние соседей на классификацию, так как каждый сосед получает вес, который зависит от расстояния до тестового объекта. Таким образом, учитывается не только количество соседей, но и их расположение в пространстве признаков. В качестве функции ядра была использована гауссова функция, которая дает больший вес ближайшим соседям, меньший - дальним.
Также была реализована функция для вычисления евклидова расстояния между двумя точками.

В качестве метрики качества была написана функция для вычисления accuracy на основе предсказаний и истинных значений.

Для подбора параметров k и bandwidth была реализована функция loo_cross_validation, которая проводит кросс-валидацию методом leave-one-out и находит наилучшие параметры, оставляя один объект для проверки и тренируя модель на оставшихся объектах. Оптимальные значения параметров были выбраны на основе минимальной средней ошибки, полученной в результате кросс-валидации.

Результат работы подбора параметров можно посмотреть в файле research.ipynb. Для оптимизации были выбраны следующие параметры: k_values = range(1, 21) и bandwidths = [0.1, 0.5, 1.0, 2.0, 5.0].
Большее количество k смысла брать нет, так как в датасете всего 150 объектов.

По итогам работы loo_cross_validation были определены оптимальные параметры:
k = 19 и bandwidth = 1.0. При таких параметрах значение accuracy составило 0.98.

Далее было проведено сравнение написанной модели с моделью KNeighborsClassifier из библиотеки sklearn.

Результаты сравнения:

KNNParzenWindow

- Best k: 19, Best bandwidth: 1.0
- Best accuracy: 0.9800
- Execution time: 7.7227 seconds

sklearn KNN

- Best k: 19
- Best accuracy: 0.9800
- Execution time: 10.9066 seconds

## Итоги

Самописная модель использует окно Парзена, более того, функция loo_cross_validation позволяет найти наилучшие параметры для модели, включая bandwidth.
По результатам работы обеих моделей лучшее k=19, accuracy=0.98.
По времени - самописная модель работает быстрее.
