# Лабораторная работа №1: Кластеризация

## План работы
1. Выбор датасетов для кластеризации:
   - Используются датасеты: **Iris** и **Citrus**.
   - Удаление меток классов.
   - Визуализация данных.
   - Гипотеза о количестве кластеров.
2. Реализация алгоритмов кластеризации:
   - Иерархическая кластеризация.
   - EM-алгоритм.
   - DBSCAN.
3. Оценка результатов:
   - Среднее внутрикластерное расстояние.
   - Среднее межкластерное расстояние.
   - Скорость кластеризации.
   - Сравнение разработанных и эталонных алгоритмов.

---
## Иерархическая кластеризация

### Дендрограммы
- Дендрограммы, построенные для каждого датасета, представлены ниже.

### Результаты

#### Метрики для датасета Iris
| Модель        | Среднее внутрикл. расстояние | Среднее межкл. расстояние | Время выполнения |
|---------------|------------------------------|---------------------------|------------------|
| Кастомная     | 0.3183                       | 0.9787                    | 0.0184 сек       |
| Эталонная     | 0.3183                       | 0.9787                    | 0.0010 сек       |

#### Метрики для датасета Citrus
| Модель        | Среднее внутрикл. расстояние | Среднее межкл. расстояние | Время выполнения |
|---------------|------------------------------|---------------------------|------------------|
| Кастомная     | 0.1755                       | 0.3863                    | 47.9518 сек      |
| Эталонная     | 0.1761                       | 0.3857                    | 0.0942 сек       |

### Графики
1. **Дендрограммы:** визуализация иерархической структуры кластеров для каждого датасета.
    - **для датасета Citrus**
![image](images\citrus_dendrogram.png)
    - **для датасета Iris**
![image](images\iris_dendrogram.png)

### Выводы
- Для датасета **Iris** оптимальное число кластеров — 2, с коэффициентом силуэта 0.629. Кастомная и эталонная реализации показывают одинаковые внутрикластерные и межкластерные расстояния, однако эталонная модель выполняется значительно быстрее.
- Для датасета **Citrus** оптимальное число кластеров — 2, с коэффициентом силуэта 0.508. Эталонная модель немного уступает кастомной по внутрикластерному расстоянию, но превосходит её по времени выполнения.
- Дендрограммы позволяют визуально определить оптимальное число кластеров, основываясь на длине разрывов между уровнями объединения.

## DBSCAN

### Зависимость количества кластеров
- Графики зависимости количества кластеров от параметров `eps` и `min_samples` представлены ниже для каждого датасета.

### Визуализация кластеров
- Визуализация кластеров в PCA-пространстве после кластеризации.
- Визуализация кластеров по двум признакам для каждого датасета.

### Результаты

#### Метрики для датасета Iris
| Модель        | Среднее внутрикл. расстояние | Среднее межкл. расстояние | Время выполнения |
|---------------|------------------------------|---------------------------|------------------|
| Кастомная     | 0.2659                       | 0.8598                    | 0.0015 сек       |
| Эталонная     | 0.2746                       | 0.9063                    | 0.0005 сек       |

#### Метрики для датасета Citrus
| Модель        | Среднее внутрикл. расстояние | Среднее межкл. расстояние | Время выполнения |
|---------------|------------------------------|---------------------------|------------------|
| Кастомная     | 0.1730                       | 0.3888                    | 0.1253 сек       |
| Эталонная     | 0.2554                       | 0.3757                    | 0.2302 сек       |

### Графики
1. **Зависимость количества кластеров:** графики, показывающие изменение количества кластеров при варьировании `eps` и `min_samples`.
    - **Расстояния(Iris)**
![image](images\dbscan_distances_iris.png)
    - **Количество кластеров(Iris)**
![image](images\dbscan_clusters_iris.png)
2. **PCA-визуализация:** распределение кластеров в двумерном пространстве после кластеризации.
    - **для датасета Citrus**
![image](images\dbscan_pca_citrus.png)
    - **для датасета Iris**
![image](images\dbscan_pca_iris.png)
3. **Двумерная визуализация:** распределение данных по выбранной паре признаков.
    - **для датасета Citrus**
![image](images\dbscan_paired_citrus.png)
    - **для датасета Iris**
![image](images\dbscan_paired_iris.png)

### Выводы
- На датасете **Iris** кастомная модель показала более низкое внутрикластерное расстояние, но эталонная модель имеет лучшее межкластерное расстояние и быстрее выполняется.
- На датасете **Citrus** кастомная модель превосходит эталонную модель по внутрикластерному расстоянию, однако эталонная модель лучше разделяет кластеры (выше межкластерное расстояние).
- Графики зависимости количества кластеров от параметров `eps` и `min_samples` позволяют определить оптимальные параметры для кластеризации.


### Графики
1. **Зависимость количества кластеров:** графики, показывающие изменение количества кластеров при варьировании `eps` и `min_samples`.
2. **PCA-визуализация:** распределение кластеров в двумерном пространстве после кластеризации.
3. **Двумерная визуализация:** распределение данных по выбранной паре признаков.

### Выводы
- На обоих датасетах кастомная и эталонная модели показали сходные результаты, но эталонная модель демонстрирует большую производительность.
- Графики зависимости количества кластеров от параметров `eps` и `min_samples` помогают выбрать оптимальные параметры для кластеризации.
- Качество кластеризации на датасетах зависит от выбора параметров и плотности данных.


## EM-алгоритм

### Логарифм правдоподобия
- График изменения логарифма правдоподобия по итерациям представлен ниже для каждого датасета.

### Визуализация кластеров
- Визуализация кластеров в PCA-пространстве после кластеризации.
- Визуализация кластеров по двум признакам для каждого датасета.

### Результаты

#### Метрики для датасета Iris
| Модель        | Среднее внутрикл. расстояние | Среднее межкл. расстояние | Время выполнения |
|---------------|------------------------------|---------------------------|------------------|
| Кастомная     | 1.3202                       | 2.7045                    | 1.0763 сек       |
| Эталонная     | 1.3202                       | 2.7072                    | 0.0913 сек       |

#### Метрики для датасета Citrus
| Модель        | Среднее внутрикл. расстояние | Среднее межкл. расстояние | Время выполнения |
|---------------|------------------------------|---------------------------|------------------|
| Кастомная     | 0.9933                       | 2.1776                    | 64.9398 сек      |
| Эталонная     | 1.2542                       | 1.4944                    | 0.1213 сек       |

### Графики
1. **Логарифм правдоподобия:** график изменения логарифма правдоподобия в процессе обучения.
    - **для датасета Citrus**
![image](images\em_likelihood_citrus.png)
    - **для датасета Iris**
![image](images\em_likelihood_iris.png)

2. **PCA-визуализация:** распределение кластеров в двумерном пространстве после кластеризации.
    - **для датасета Citrus**
![image](images\em_pca_citrus.png)
    - **для датасета Iris**
![image](images\em_pca_iris.png)
3. **Двумерная визуализация:** распределение данных по выбранной паре признаков.
    - **для датасета Citrus**
![image](images\em_paired_citrus.png)
    - **для датасета Iris**
![image](images\em_paired_iris.png)
### Выводы
- На датасете **Iris** кастомная и эталонная модели показали схожие результаты по метрикам внутрикластерного и межкластерного расстояний. Однако эталонная модель значительно быстрее (0.0913 сек против 1.0763 сек).
- На датасете **Citrus** кастомная модель показала лучшее межкластерное расстояние (2.1776 против 1.4944), но за счёт значительного увеличения времени выполнения (64.9398 сек против 0.1213 сек).
- Логарифм правдоподобия в обеих моделях сходился за разумное число итераций.


